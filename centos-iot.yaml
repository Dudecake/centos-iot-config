include: centos-common-ostree.yaml
ref: centos/8/${basearch}/iot
rojig:
  name: centos-iot
  summary: "Centos IoT base image"
  license: MIT
packages:
  - bsdtar
  - iotop
  - micro
  - zsh
  - zsh-syntax-highlighting
  - centos-release-advanced-virtualization
  - centos-release-gluster8
  # - centos-release-nfs-ganesha30
  - centos-release-opstools
  # - centos-release-ovirt44
  - epel-release
  - freeipa-client
  - keepalived
  - ncdu
  - wireguard-tools
  # Cockpit
  - cockpit-networkmanager
  - cockpit-machines
  - cockpit-podman
  - cockpit-storaged
  # Convenient hooks for Podman/Docker
  - oci-systemd-hook
  - oci-umount
  # Automatic decryption on boot
  - clevis-dracut
  # Ovirt
  # - ovirt-engine
  # - cockpit-ovirt-dashboard
  - virtio-win
  - virt-install
  - virt-top
  - libvirt-daemon-kvm
  - libvirt-daemon-driver-storage-gluster
  - libvirt-daemon-driver-storage-iscsi
  - qemu-kvm
  # - qemu-system-aarch64
  # - qemu-system-arm
  # - qemu-system-ppc
  # - qemu-system-riscv
  # - qemu-system-x86
  - libguestfs-tools
  - python3-libguestfs
  # Kubernetes
  - cri-o
  - conntrack-tools
  # Storage
  - glusterfs
  - glusterfs-server
  - targetcli
  - nfs-utils
  - zfs
  - rubygems
packages-aarch64:
  - edk2-aarch64
packages-x86_64:
  - edk2-ovmf
  # GPU support
  # - rocm-smi
  # - rocminfo
  # - rocm-opencl
  # - clinfo
  # - radeontop

units:
  - rpm-ostreed-automatic.timer
  - cockpit.socket
  - ostree-remount.service
  - crio.service
  - io.podman.socket

add-files:
  [
    ["ls-iommu.sh", "/usr/bin/ls-iommu.sh"],
    ["ls-reset.sh", "/usr/bin/ls-reset.sh"],
    ["kubectl", "/usr/bin/kubectl"],
    ["kube-scheduler.docker_tag", "/usr/bin/kube-scheduler.docker_tag"],
    ["kube-scheduler", "/usr/bin/kube-scheduler"],
    ["kube-proxy.tar", "/usr/bin/kube-proxy.tar"],
    [
      "kube-controller-manager.docker_tag",
      "/usr/bin/kube-controller-manager.docker_tag",
    ],
    ["apiextensions-apiserver", "/usr/bin/apiextensions-apiserver"],
    ["kube-apiserver.tar", "/usr/bin/kube-apiserver.tar"],
    ["kube-proxy.docker_tag", "/usr/bin/kube-proxy.docker_tag"],
    ["kube-proxy", "/usr/bin/kube-proxy"],
    ["kubelet", "/usr/bin/kubelet"],
    ["kube-aggregator", "/usr/bin/kube-aggregator"],
    ["kube-apiserver.docker_tag", "/usr/bin/kube-apiserver.docker_tag"],
    ["kube-controller-manager", "/usr/bin/kube-controller-manager"],
    ["kube-scheduler.tar", "/usr/bin/kube-scheduler.tar"],
    ["kube-controller-manager.tar", "/usr/bin/kube-controller-manager.tar"],
    ["kube-apiserver", "/usr/bin/kube-apiserver"],
    ["mounter", "/usr/bin/mounter"],
    ["kubeadm", "/usr/bin/kubeadm"],
    ["kubelet.service", "/etc/systemd/system/kubelet.service"],
    ["crictl", "/usr/bin/crictl"],
    ["initialize-kubernetes.sh", "/usr/bin/initialize-kubernetes.sh"],
  ]

# ["rocm.sh", "/etc/profile.d/rocm.sh"],
default-target: multi-user.target
# readonly-executables: true
# TODO: enable modules pki-deps, postgresql:12 and javapackages-tools
repos:
  # CentOS repos
  - AppStream
  - BaseOS
  - PowerTools
  - extras
  - epel
  # ZFS repo
  # - zfs-kmod
  - zfs
  # OVirt
  - centos-advanced-virtualization
  - centos-gluster8
  # - centos-ovirt44
  - centos-opstools
  - virtio-win-latest
  # - ovirt-4.4
  # - ovirt-4.4-copr:copr.fedorainfracloud.org:sbonazzo:EL8_collection
  # - ovirt-4.4-copr:copr.fedorainfracloud.org:sac:gluster-ansible
  # - ovirt-4.4-copr:copr.fedorainfracloud.org:mdbarroso:ovsdbapp
  # - ovirt-4.4-copr:copr.fedorainfracloud.org:nmstate:nmstate-0.3
  # - ovirt-4.4-copr:copr.fedorainfracloud.org:networkmanager:NetworkManager-1.26
  # Kubernetes
  - copr:copr.fedorainfracloud.org:rhcontainerbot:container-selinux
  - devel_kubic_libcontainers_stable
  - devel_kubic_libcontainers_stable_cri-o_1.20
  # GPU support
  # - ROCm
